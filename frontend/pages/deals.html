<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deals & Offers - Magenta</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <a href="../index.html">
                        <i class="fas fa-book-open"></i>
                        <span>Magenta</span>
                    </a>
                </div>
                
                <div class="nav-menu">
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="../index.html" class="nav-link">Home</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link">Categories <i class="fas fa-chevron-down"></i></a>
                            <ul class="dropdown-menu">
                                <li><a href="category.html?cat=Aqeedah">Aqeedah</a></li>
                                <li><a href="category.html?cat=Fiqh">Fiqh</a></li>
                                <li><a href="category.html?cat=Qur'an">Qur'an</a></li>
                                <li><a href="category.html?cat=Arabic">Arabic</a></li>
                                <li><a href="category.html?cat=Hadith">Hadith</a></li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="bestsellers.html" class="nav-link">Bestsellers</a>
                        </li>
                        <li class="nav-item">
                            <a href="deals.html" class="nav-link active">Deals</a>
                        </li>
                    </ul>
                </div>

                <div class="nav-actions">
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Search books, authors...">
                        <button id="searchBtn"><i class="fas fa-search"></i></button>
                    </div>
                    
                    <div class="user-actions">
                        <a href="cart.html" class="action-btn" title="Shopping Cart">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="badge" id="cartCount">0</span>
                        </a>
                        <div class="user-menu">
                            <button class="user-btn" id="userBtn">
                                <i class="fas fa-user"></i>
                            </button>
                            <div class="user-dropdown" id="userDropdown">
                                <a href="login.html" id="loginLink">Login</a>
                                <a href="register.html" id="registerLink">Register</a>
                                <a href="profile.html" id="profileLink" style="display: none;">My Profile</a>
                                <a href="orders.html" id="ordersLink" style="display: none;">My Orders</a>
                                <a href="#" id="logoutLink" style="display: none;">Logout</a>
                            </div>
                        </div>
                    </div>

                    <div class="hamburger" id="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Deals Hero -->
    <section class="deals-hero">
        <div class="container">
            <div class="hero-content">
                <h1>Amazing Deals</h1>
                <p>Save big on your favorite books with our exclusive offers</p>
                <div class="countdown-timer" id="countdownTimer">
                    <div class="timer-item">
                        <span class="timer-number" id="days">00</span>
                        <span class="timer-label">Days</span>
                    </div>
                    <div class="timer-item">
                        <span class="timer-number" id="hours">00</span>
                        <span class="timer-label">Hours</span>
                    </div>
                    <div class="timer-item">
                        <span class="timer-number" id="minutes">00</span>
                        <span class="timer-label">Minutes</span>
                    </div>
                    <div class="timer-item">
                        <span class="timer-number" id="seconds">00</span>
                        <span class="timer-label">Seconds</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Deals -->
    <section class="featured-deals">
        <div class="container">
            <h2>Featured Deals</h2>
            <div class="deals-grid" id="featuredDeals">
                <!-- Featured deals will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Deal Categories -->
    <section class="deal-categories">
        <div class="container">
            <div class="categories-tabs">
                <button class="category-tab active" data-category="all">All Deals</button>
                <button class="category-tab" data-category="flash">Flash Sales</button>
                <button class="category-tab" data-category="clearance">Clearance</button>
                <button class="category-tab" data-category="bundle">Book Bundles</button>
                <button class="category-tab" data-category="daily">Daily Deals</button>
            </div>
        </div>
    </section>

    <!-- Flash Sales -->
    <section class="flash-sales">
        <div class="container">
            <div class="section-header">
                <h2>Flash Sales</h2>
                <p>Limited time offers - don't miss out!</p>
            </div>
            <div class="flash-sales-grid" id="flashSales">
                <!-- Flash sales will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Clearance Section -->
    <section class="clearance-section">
        <div class="container">
            <div class="section-header">
                <h2>Clearance Sale</h2>
                <p>Up to 80% off selected titles</p>
            </div>
            <div class="clearance-filters">
                <button class="filter-btn active" data-discount="all">All</button>
                <button class="filter-btn" data-discount="50">50%+ Off</button>
                <button class="filter-btn" data-discount="60">60%+ Off</button>
                <button class="filter-btn" data-discount="70">70%+ Off</button>
                <button class="filter-btn" data-discount="80">80%+ Off</button>
            </div>
            <div class="books-grid" id="clearanceBooks">
                <!-- Clearance books will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Book Bundles -->
    <section class="book-bundles">
        <div class="container">
            <h2>Book Bundles</h2>
            <div class="bundles-grid" id="bookBundles">
                <!-- Book bundles will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Daily Deals -->
    <section class="daily-deals">
        <div class="container">
            <div class="section-header">
                <h2>Daily Deals</h2>
                <p>New deals every day at midnight</p>
            </div>
            <div class="daily-deals-grid" id="dailyDeals">
                <!-- Daily deals will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Coupon Codes -->
    <section class="coupon-codes">
        <div class="container">
            <h2>Coupon Codes</h2>
            <div class="coupons-grid" id="couponCodes">
                <!-- Coupon codes will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Deal Alerts -->
    <section class="deal-alerts">
        <div class="container">
            <div class="alert-content">
                <h2>Never Miss a Deal</h2>
                <p>Subscribe to our deal alerts and be the first to know about new offers</p>
                <form class="deal-alerts-form" id="dealAlertForm">
                    <div class="form-group">
                        <label for="alertEmail"><i class="fas fa-envelope"></i> Email Address</label>
                        <input type="email" id="alertEmail" placeholder="Enter your email address" required>
                    </div>
                    <div class="form-group">
                        <label for="alertCategories"><i class="fas fa-list"></i> Categories of Interest</label>
                        <!-- Custom dropdown slider multi-select start -->
                        <div id="customDropdownContainer" class="custom-dropdown-container">
                          <div id="dropdownButton" class="dropdown-button" tabindex="0" aria-haspopup="listbox" aria-expanded="false">
                            <span id="dropdownButtonText">Select categories</span>
                            <span class="dropdown-arrow">&#9662;</span>
                          </div>
                          <div id="dropdownPanel" class="dropdown-panel" style="display:none;">
                            <button type="button" id="dropdownPrev" class="slider-arrow" aria-label="Previous category">
                              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 6L9 12L15 18" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                            </button>
                            <span id="dropdownCurrentCategory" class="slider-category"></span>
                            <button type="button" id="dropdownNext" class="slider-arrow" aria-label="Next category">
                              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 6L15 12L9 18" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                            </button>
                            <button type="button" id="dropdownAddBtn" class="slider-add">Add</button>
                          </div>
                        </div>
                        <div id="selectedCategoriesContainer"></div>
                        <div id="selectedCategoriesInputs"></div>
                        <!-- Custom dropdown slider multi-select end -->
                    </div>
                    <button type="submit" class="btn btn-primary">Subscribe to Alerts</button>
                    <div id="dealAlertMessage" style="display:none;margin-top:1rem;"></div>
                </form>
            </div>
        </div>
    </section>
    <script src="../js/booksData.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/cart.js"></script>
    <script src="../js/auth.js"></script>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('dealAlertForm');
    const emailInput = document.getElementById('alertEmail');
    const categoriesSelect = document.getElementById('alertCategories');
    const messageDiv = document.getElementById('dealAlertMessage');

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = emailInput.value.trim();
        const selected = Array.from(categoriesSelect.selectedOptions).map(opt => opt.value);
        messageDiv.style.display = 'none';
        messageDiv.className = '';

        // Email validation
        if (!email.match(/^\S+@\S+\.\S+$/)) {
            messageDiv.textContent = 'Please enter a valid email address.';
            messageDiv.style.display = 'block';
            messageDiv.style.color = '#e74c3c';
            return;
        }
        // At least one category
        if (selected.length === 0) {
            messageDiv.textContent = 'Please select at least one category.';
            messageDiv.style.display = 'block';
            messageDiv.style.color = '#e74c3c';
            return;
        }
        // Simulate success (replace with real API call if needed)
        messageDiv.textContent = 'Thank you for subscribing to deal alerts!';
        messageDiv.style.display = 'block';
        messageDiv.style.color = '#2bff05';
        form.reset();
    });
});
// Custom dropdown slider multi-select logic
const categories = [
  { value: 'Aqeedah', label: 'Aqeedah' },
  { value: 'Fiqh', label: 'Fiqh' },
  { value: "Qur'an", label: "Qur'an" },
  { value: 'Arabic', label: 'Arabic' },
  { value: 'Hadith', label: 'Hadith' }
];
let currentCategoryIndex = 0;
let selectedCategories = [];

function updateDropdownCategory() {
  const cat = categories[currentCategoryIndex];
  document.getElementById('dropdownCurrentCategory').textContent = cat.label;
  document.getElementById('dropdownAddBtn').disabled = selectedCategories.includes(cat.value);
}

function renderSelectedCategories() {
  const container = document.getElementById('selectedCategoriesContainer');
  const inputs = document.getElementById('selectedCategoriesInputs');
  container.innerHTML = '';
  inputs.innerHTML = '';
  selectedCategories.forEach(val => {
    const cat = categories.find(c => c.value === val);
    const tag = document.createElement('span');
    tag.className = 'selected-category-tag';
    tag.textContent = cat ? cat.label : val;
    const removeBtn = document.createElement('button');
    removeBtn.type = 'button';
    removeBtn.className = 'remove-category-btn';
    removeBtn.innerHTML = '&times;';
    removeBtn.onclick = () => {
      selectedCategories = selectedCategories.filter(v => v !== val);
      renderSelectedCategories();
      updateDropdownButtonText();
      updateDropdownCategory();
    };
    tag.appendChild(removeBtn);
    container.appendChild(tag);
    const input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'alertCategories[]';
    input.value = val;
    inputs.appendChild(input);
  });
}

function updateDropdownButtonText() {
  const btnText = document.getElementById('dropdownButtonText');
  if (selectedCategories.length === 0) {
    btnText.textContent = 'Select categories';
  } else if (selectedCategories.length === 1) {
    const cat = categories.find(c => c.value === selectedCategories[0]);
    btnText.textContent = cat ? cat.label : selectedCategories[0];
  } else {
    btnText.textContent = `${selectedCategories.length} categories selected`;
  }
}

document.addEventListener('DOMContentLoaded', function() {
  // Dropdown logic
  updateDropdownCategory();
  renderSelectedCategories();
  updateDropdownButtonText();
  const dropdownButton = document.getElementById('dropdownButton');
  const dropdownPanel = document.getElementById('dropdownPanel');
  let dropdownOpen = false;

  function openDropdown() {
    dropdownPanel.style.display = 'flex';
    dropdownButton.setAttribute('aria-expanded', 'true');
    dropdownOpen = true;
  }
  function closeDropdown() {
    dropdownPanel.style.display = 'none';
    dropdownButton.setAttribute('aria-expanded', 'false');
    dropdownOpen = false;
  }
  dropdownButton.onclick = function(e) {
    dropdownOpen ? closeDropdown() : openDropdown();
  };
  dropdownButton.onkeydown = function(e) {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      dropdownOpen ? closeDropdown() : openDropdown();
    }
  };
  document.getElementById('dropdownPrev').onclick = function() {
    currentCategoryIndex = (currentCategoryIndex - 1 + categories.length) % categories.length;
    updateDropdownCategory();
  };
  document.getElementById('dropdownNext').onclick = function() {
    currentCategoryIndex = (currentCategoryIndex + 1) % categories.length;
    updateDropdownCategory();
  };
  document.getElementById('dropdownAddBtn').onclick = function() {
    const val = categories[currentCategoryIndex].value;
    if (!selectedCategories.includes(val)) {
      selectedCategories.push(val);
      renderSelectedCategories();
      updateDropdownButtonText();
      updateDropdownCategory();
      closeDropdown(); // Close after adding
    }
  };
  // Close dropdown when clicking outside
  document.addEventListener('mousedown', function(e) {
    if (!document.getElementById('customDropdownContainer').contains(e.target)) {
      closeDropdown();
    }
  });
  // On form submit, validate at least one selected
  const form = document.getElementById('dealAlertForm');
  const emailInput = document.getElementById('alertEmail');
  const messageDiv = document.getElementById('dealAlertMessage');
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    const email = emailInput.value.trim();
    messageDiv.style.display = 'none';
    messageDiv.className = '';
    if (!email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
      messageDiv.textContent = 'Please enter a valid email address.';
      messageDiv.style.display = 'block';
      messageDiv.style.color = '#e74c3c';
      return;
    }
    if (selectedCategories.length === 0) {
      messageDiv.textContent = 'Please select at least one category.';
      messageDiv.style.display = 'block';
      messageDiv.style.color = '#e74c3c';
      return;
    }
    messageDiv.textContent = 'Thank you for subscribing to deal alerts!';
    messageDiv.style.display = 'block';
    messageDiv.style.color = '#2bff05';
    form.reset();
    selectedCategories = [];
    renderSelectedCategories();
    updateDropdownButtonText();
    updateDropdownCategory();
  });
});
    </script>
    <style>
      /* Custom modern dark select styling for #alertCategories */
      #alertCategories {
        width: 100%;
        min-height: 120px;
        background: #18183a;
        color: #fff;
        border: 2px solid #444;
        border-radius: 10px;
        padding: 12px 40px 12px 16px;
        font-size: 1rem;
        font-family: inherit;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        transition: border-color 0.2s, box-shadow 0.2s;
        outline: none;
        position: relative;
        background-image: url('data:image/svg+xml;utf8,<svg fill="white" height="18" viewBox="0 0 24 24" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
        background-repeat: no-repeat;
        background-position: right 12px center;
        background-size: 18px 18px;
      }
      #alertCategories:focus {
        border-color: #7b5cff;
        box-shadow: 0 0 0 2px #7b5cff44;
      }
      #alertCategories option {
        background: #232347;
        color: #fff;
        padding: 8px;
      }
      /* Remove default arrow in some browsers */
      select[multiple]::-ms-expand {
        display: none;
      }
      select[multiple]::-webkit-scrollbar {
        width: 8px;
        background: #232347;
      }
      select[multiple]::-webkit-scrollbar-thumb {
        background: #444;
        border-radius: 4px;
      }
      /* Custom dropdown slider multi-select styles */
      .custom-dropdown-container {
        position: relative;
        width: 100%;
        margin-bottom: 0.5rem;
      }
      .dropdown-button {
        width: 100%;
        background: #18183a;
        color: #fff;
        border: 2px solid #444;
        border-radius: 10px;
        padding: 12px 40px 12px 16px;
        font-size: 1rem;
        font-family: inherit;
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: pointer;
        transition: border-color 0.2s, box-shadow 0.2s;
        outline: none;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      }
      .dropdown-button:focus {
        border-color: #7b5cff;
        box-shadow: 0 0 0 2px #7b5cff44;
      }
      .dropdown-arrow {
        margin-left: 10px;
        font-size: 1.2rem;
      }
      .dropdown-panel {
        position: absolute;
        top: 110%;
        left: 0;
        width: 100%;
        background: #18183a;
        border: 2px solid #444;
        border-radius: 10px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.18);
        z-index: 10;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 12px 10px;
      }
      .slider-arrow {
        background: linear-gradient(90deg, #7b5cff, #5cafff);
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 1.3rem;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(123,92,255,0.10);
        cursor: pointer;
        transition: background 0.2s, box-shadow 0.2s, transform 0.15s;
        outline: none;
        margin: 0 4px;
        padding: 0;
      }
      .slider-arrow svg {
        width: 22px;
        height: 22px;
        display: block;
      }
      .slider-arrow:active {
        transform: scale(0.95);
      }
      .slider-arrow:focus {
        box-shadow: 0 0 0 2px #7b5cff55;
      }
      .slider-arrow:hover:not(:disabled) {
        background: linear-gradient(90deg, #5cafff, #7b5cff);
        box-shadow: 0 4px 16px rgba(92,175,255,0.18);
      }
      .slider-category {
        flex: 1;
        text-align: center;
        font-size: 1.1rem;
        color: #fff;
        font-weight: 500;
        letter-spacing: 0.5px;
      }
      .slider-add {
        background: linear-gradient(90deg, #7b5cff, #ff5ca7);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 6px 18px;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.2s;
      }
      .slider-add:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      #selectedCategoriesContainer {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
      }
      .selected-category-tag {
        background: #232347;
        color: #fff;
        border-radius: 6px;
        padding: 4px 12px 4px 8px;
        display: flex;
        align-items: center;
        font-size: 0.98rem;
        position: relative;
      }
      .remove-category-btn {
        background: none;
        border: none;
        color: #ff5ca7;
        font-size: 1.1rem;
        margin-left: 6px;
        cursor: pointer;
        border-radius: 50%;
        width: 22px;
        height: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s;
      }
      .remove-category-btn:hover {
        background: #7b5cff33;
      }
    </style>
</body>
</html> 
